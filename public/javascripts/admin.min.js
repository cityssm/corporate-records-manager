"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=exports.urlPrefix,t=document.getElementById("container--users"),s=[],a=function(t){t.preventDefault();var a=t.currentTarget;a.disabled=!0;var i=a.getAttribute("data-field"),r=a.closest("tr"),n=parseInt(r.getAttribute("data-index"),10),c=s[n],l=!c[i];cityssm.postJSON(e+"/admin/doSetUserSetting",{userName:c.userName,fieldName:i,fieldValue:l},function(e){if(a.disabled=!1,e.success)if(c[i]=l,l)switch(i){case"isActive":a.innerHTML='<i class="fas fa-user-check" aria-label="Active User"></i>';break;case"canUpdate":a.innerHTML='<i class="fas fa-pencil-alt" aria-label="Update User"></i>';break;case"isAdmin":a.innerHTML='<i class="fas fa-cog" aria-label="Admin User"></i>'}else a.innerHTML='<i class="fas fa-minus" aria-label="False"></i>';else cityssm.alertModal("User Setting Not Updated",cityssm.escapeHTML(e.message),"OK","danger")})},i=function(t){t.preventDefault();var a=t.currentTarget,i=a.closest("tr"),n=parseInt(i.getAttribute("data-index"),10),c=s[n].userName;cityssm.confirmModal("Remove User?",'Are you sure you want to remove all access for "'+c+'"?',"Yes, Remove User","warning",function(){a.disabled=!0,cityssm.postJSON(e+"/admin/doRemoveUser",{userName:c},function(e){e.success?(s.splice(n,1),r()):(cityssm.alertModal("Error Removing User",cityssm.escapeHTML(e.message),"OK","danger"),a.disabled=!1)})})},r=function(){if(0!==s.length){var e=document.createElement("table");e.className="table is-fullwidth is-bordered is-striped is-hoverable has-sticky-header",e.innerHTML='<thead><tr><th>User Name</th><th class="has-text-centered">Is Active</th><th class="has-text-centered">Can Update</th><th class="has-text-centered">Is Admin</th><th class="has-text-centered">Remove</th></tr></thead><tbody></tbody>';for(var r=e.getElementsByTagName("tbody")[0],n=0;n<s.length;n+=1){var c=s[n],l=document.createElement("tr");l.setAttribute("data-index",n.toString()),l.innerHTML='<th class="is-vcentered">'+c.userName+'</th><td class="has-text-centered"><button class="button is-inverted is-info" data-field="isActive" type="button">'+(c.isActive?'<i class="fas fa-user-check" aria-label="Active User"></i>':'<i class="fas fa-minus" aria-label="False"></i>')+'</button></td><td class="has-text-centered"><button class="button is-inverted is-info" data-field="canUpdate" type="button">'+(c.canUpdate?'<i class="fas fa-pencil-alt" aria-label="Update User"></i>':'<i class="fas fa-minus" aria-label="False"></i>')+'</button></td><td class="has-text-centered"><button class="button is-inverted is-info" data-field="isAdmin" type="button">'+(c.isAdmin?'<i class="fas fa-cog" aria-label="Admin User"></i>':'<i class="fas fa-minus" aria-label="False"></i>')+'</button></td><td class="has-text-centered"><button class="button is-inverted is-danger is-remove-user-button" type="button"><i class="fas fa-trash-alt" aria-label="Remove User"></i></button></td>';for(var d=l.getElementsByTagName("button"),o=0;o<d.length;o+=1)d[o].classList.contains("is-remove-user-button")?d[o].addEventListener("click",i):d[o].addEventListener("click",a);r.appendChild(l)}cityssm.clearElement(t),t.appendChild(e)}else t.innerHTML='<div class="message is-warning"><p class="message-body"><strong>There are no users in the system.</strong><br />Please create at least one user.</p></div>'};document.getElementById("form--addUser").addEventListener("submit",function(t){t.preventDefault();var a=t.currentTarget;cityssm.postJSON(e+"/admin/doAddUser",a,function(e){e.success?(a.reset(),s.unshift(e.user),r()):cityssm.alertModal("Error Creating New User",cityssm.escapeHTML(e.message),"OK","danger")})});var n=document.getElementById("admin--tabs").querySelectorAll("[role='tab']"),c=document.getElementById("admin--tabpanels").querySelectorAll("[role='tabpanel']"),l=function(a){a.preventDefault();var i=a.currentTarget;switch(c.forEach(function(e){e.classList.add("is-hidden")}),n.forEach(function(e){e.classList.remove("is-active"),e.setAttribute("aria-selected","false")}),i.classList.add("is-active"),i.setAttribute("aria-selected","true"),document.getElementById(i.getAttribute("aria-controls")).classList.remove("is-hidden"),i.getAttribute("aria-controls").split("--")[1]){case"users":s=[],cityssm.clearElement(t),t.innerHTML='<div class="has-text-centered has-text-grey-dark"><i class="fas fa-4x fa-pulse fa-spinner" aria-hidden="true"></i><br /><em>Loading Users...</em></div>',cityssm.postJSON(e+"/admin/doGetUsers",{},function(e){s=e.users,r()})}};n.forEach(function(e){e.addEventListener("click",l)})}();