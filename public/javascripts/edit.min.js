"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=exports.urlPrefix,t=document.getElementById("record--recordID").value,s=document.getElementById("record--recordTypeKey"),a=(s.value,s.getAttribute("data-record-type"),function(e){for(var t=e.getElementsByClassName("panel-block"),s=0;s<t.length;s+=1)t[s].remove()}),n=document.getElementById("panel--statuses");exports.recordStatuses,a(n),delete exports.recordStatuses;var r=document.getElementById("panel--urls"),d=function(e){if(a(r),0!==e.length)for(var t=0,s=e;t<s.length;t++){var n=s[t],d=document.createElement("div");d.className="panel-block is-block",d.setAttribute("data-url-id",n.urlID.toString()),d.innerHTML='<a class="has-text-weight-bold" href="'+cityssm.escapeHTML(n.url)+'" target="_blank">'+cityssm.escapeHTML(n.urlTitle)+'</a><br /><span class="tag">'+n.url.split("/")[2]+"</span>"+cityssm.escapeHTML(n.urlDescription),r.appendChild(d)}else r.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-info"><div class="message-body">There are no links associated with this record.</div></div></div>')},i=document.getElementById("is-add-docushare-url-button");i&&i.addEventListener("click",function(){var s,n,i=!1,c=function(s){s.preventDefault();var a=s.currentTarget;a.disabled=!0;var n=a.closest(".panel-block"),r=n.getAttribute("data-handle");cityssm.postJSON(e+"/edit/doAddDocuShareLink",{recordID:t,handle:r},function(e){e.success?(i=!0,n.remove()):(cityssm.alertModal("Error Adding Link",cityssm.escapeHTML(e.message),"OK","danger"),a.disabled=!1)})},l=function(t){t&&t.preventDefault(),n.innerHTML='<div class="has-text-centered has-text-grey"><i class="fas fa-4x fa-spinner fa-pulse" aria-hidden="true"></i><br />Searching DocuShare...</div>',cityssm.postJSON(e+"/edit/doSearchDocuShare",s,function(e){if(e.success){var t=document.createElement("div");t.className="panel";for(var s=0,a=e.dsObjects;s<a.length;s++){var d=a[s];if(!r.querySelector("a[href='"+d.url+"']")){var i=document.createElement("div");i.className="panel-block is-block",i.setAttribute("data-handle",d.handle),i.innerHTML='<div class="level"><div class="level-left"><strong>'+cityssm.escapeHTML(d.title)+'</strong></div><div class="level-right"><a class="button is-info mr-1" href="'+d.url+'" target="_blank"><span class="icon"><i class="fas fa-eye" aria-hidden="true"></i></span><span>View</span></a><button class="button is-success" type="button"><span class="icon"><i class="fas fa-plus" aria-hidden="true"></i></span><span>Add Link</span></button></div></div>',i.getElementsByTagName("button")[0].addEventListener("click",c),t.appendChild(i)}}n.innerHTML="",0===t.children.length?n.innerHTML='<div class="message is-info"><div class="message-body"><p>There are no new files in DocuShare that meet your search criteria.</p></div></div>':n.appendChild(t)}else n.innerHTML='<div class="message is-danger"><div class="message-body"><p>An error occurred retrieving documents from DocuShare.</p><p>'+cityssm.escapeHTML(e.message)+"</p></div></div>"})};cityssm.openHtmlModal("docushare-url-add",{onshow:function(){n=document.getElementById("container--addDocuShareURL"),(s=document.getElementById("form--addDocuShareURL-search")).addEventListener("submit",l);for(var e=document.getElementById("addDocuShareURL--collectionHandleIndex"),t=0;t<exports.docuShareCollectionHandles.length;t+=1){var a=document.createElement("option");a.value=t.toString(),a.innerText=exports.docuShareCollectionHandles[t].title,e.appendChild(a),0===t&&(e.value=t.toString())}e.addEventListener("change",l),document.getElementById("addDocuShareURL--searchString").value=document.getElementById("record--recordNumber").value,l()},onhidden:function(){i&&(a(r),r.insertAdjacentHTML("beforeend",'<div class="panel-block is-block has-text-centered has-text-grey"><i class="fas fa-4x fa-spinner fa-pulse" aria-hidden="true"></i><br />Loading Links...</div>'),cityssm.postJSON(e+"/view/doGetURLs",{recordID:t},function(e){e.success?d(e.urls):r.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-danger"><div class="message-body">'+e.message+"</div></div></div>")}))}})}),d(exports.recordURLs),delete exports.recordURLs;document.getElementById("panel--relatedRecords");var c=document.getElementById("panel--comments");exports.recordComments,a(c),delete exports.recordComments}();