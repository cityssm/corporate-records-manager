"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=exports.urlPrefix,t=document.getElementById("record--recordID").value,s=document.getElementById("record--recordTypeKey"),r=(s.value,s.getAttribute("data-record-type"),function(e){for(var t=e.getElementsByClassName("panel-block"),s=0;s<t.length;s+=1)t[s].remove()}),a=document.getElementById("panel--statuses");exports.recordStatuses,r(a),delete exports.recordStatuses;var n=document.getElementById("panel--urls"),d=document.getElementById("is-add-docushare-url-button");d&&d.addEventListener("click",function(){var s,r,a=function(s){s.preventDefault();var r=s.currentTarget;r.disabled=!0;var a=r.closest(".panel-block"),n=a.getAttribute("data-handle");alert(n),cityssm.postJSON(e+"/edit/doAddDocuShareLink",{recordID:t,handle:n},function(e){e.success?(!0,a.remove()):(cityssm.alertModal("Error Adding Link",cityssm.escapeHTML(e.message),"OK","danger"),r.disabled=!1)})},d=function(t){t&&t.preventDefault(),r.innerHTML='<div class="has-text-centered has-text-grey"><i class="fas fa-4x fa-spinner fa-pulse" aria-hidden="true"></i><br />Searching DocuShare...</div>',cityssm.postJSON(e+"/edit/doSearchDocuShare",s,function(e){if(e.success){var t=document.createElement("div");t.className="panel";for(var s=0,d=e.dsObjects;s<d.length;s++){var c=d[s];if(!n.querySelector("a[href='"+c.url+"']")){var o=document.createElement("div");o.className="panel-block is-block",o.setAttribute("data-handle",c.handle),o.innerHTML='<div class="level"><div class="level-left"><strong>'+cityssm.escapeHTML(c.title)+'</strong></div><div class="level-right"><a class="button is-info" href="'+c.url+'" target="_blank">View Document</a> <button class="button is-success" type="button">Add Link</button></div></div>',o.getElementsByTagName("button")[0].addEventListener("click",a),t.appendChild(o)}}r.innerHTML="",0===t.children.length?r.innerHTML='<div class="message is-info"><div class="message-body"><p>There are no new files in DocuShare that meet your search criteria.</p></div></div>':r.appendChild(t)}else r.innerHTML='<div class="message is-danger"><div class="message-body"><p>An error occurred retrieving documents from DocuShare.</p><p>'+cityssm.escapeHTML(e.message)+"</p></div></div>"})};cityssm.openHtmlModal("docushare-url-add",{onshow:function(){r=document.getElementById("container--addDocuShareURL"),(s=document.getElementById("form--addDocuShareURL-search")).addEventListener("submit",d);for(var e=document.getElementById("addDocuShareURL--collectionHandleIndex"),t=0;t<exports.docuShareCollectionHandles.length;t+=1){var a=document.createElement("option");a.value=t.toString(),a.innerText=exports.docuShareCollectionHandles[t].title,e.appendChild(a),0===t&&(e.value=t.toString())}e.addEventListener("change",d),document.getElementById("addDocuShareURL--searchString").value=document.getElementById("record--recordNumber").value,d()},onhidden:function(){}})}),function(e){if(r(n),0!==e.length)for(var t=0,s=e;t<s.length;t++){var a=s[t],d=document.createElement("div");d.className="panel-block is-block",d.setAttribute("data-url-id",a.urlID.toString()),d.innerHTML='<a class="has-text-weight-bold" href="'+cityssm.escapeHTML(a.url)+'" target="_blank">'+cityssm.escapeHTML(a.urlTitle)+'</a><br /><span class="tag">'+a.url.split("/")[2]+"</span>"+cityssm.escapeHTML(a.urlDescription),n.appendChild(d)}else n.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-info"><div class="message-body">There are no links associated with this record.</div></div></div>')}(exports.recordURLs),delete exports.recordURLs;document.getElementById("panel--relatedRecords");var c=document.getElementById("panel--comments");exports.recordComments,r(c),delete exports.recordComments}();