"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.urlPrefix,t=document.querySelector("#record--recordID").value,o=""===t,n=document.querySelector("#form--record"),r=()=>{cityssm.enableNavBlocker()};n.addEventListener("submit",t=>{t.preventDefault();const r=e+(o?"/new/doCreate":"/edit/doUpdate");cityssm.postJSON(r,n,t=>{t.success?(cityssm.disableNavBlocker(),o?window.location.href=e+"/edit/"+t.recordID.toString():cityssm.alertModal("Record Updated Successfully","","OK","success")):cityssm.alertModal("Error While Saving",t.message,"OK","danger")})});const s=n.querySelectorAll("input, textarea");for(const e of s)e.addEventListener("change",r);const a=e=>{e.preventDefault();const t=e.currentTarget.closest(".tag"),o=t.querySelector("input").value;cityssm.confirmModal("Remove Tag?",'Are you sure you want to remove the <span class="tag">'+cityssm.escapeHTML(o)+"</span> tag?","Yes, Remove the Tag","warning",()=>{t.remove(),r()})};document.querySelector("#is-add-tag-button").addEventListener("click",n=>{let s,c;n.preventDefault();let l="",d=[];const u=e=>{e.preventDefault();const t=document.querySelector("#addTag--tag");""!==t.value?((e=>{const t=cityssm.escapeHTML(e),o=document.createElement("span");o.className="tag is-medium",o.innerHTML='<input name="tags" type="hidden" value="'+t+'" /> '+t+' <button class="delete" type="button" aria-label="Remove Tag"></button>',o.querySelectorAll("button")[0].addEventListener("click",a),document.querySelector("#container--tags").insertAdjacentElement("afterbegin",o),r()})(t.value),t.value="",t.focus()):s()},i=n=>{n&&(l===c.value||c.value.includes(l)&&d.length<20)||(l=c.value,cityssm.postJSON(e+"/edit/doGetSuggestedTags",{recordID:o?"":t,searchString:c.value},e=>{const t=document.querySelector("#addTag--tag-datalist");if(t.innerHTML="",e.success){d=e.tags;for(const e of d){const o=document.createElement("option");o.value=e,t.append(o)}}}))};cityssm.openHtmlModal("tag-add",{onshown:(e,t)=>{s=t,document.querySelector("#form--addTag").addEventListener("submit",u),(c=document.querySelector("#addTag--tag")).focus(),c.addEventListener("keyup",i),i()}})});const c=document.querySelectorAll(".is-remove-tag-button");for(const e of c)e.addEventListener("click",a)})(),(()=>{const e=e=>{e.preventDefault();const t=e.currentTarget.closest(".field").querySelector("input"),o=t.nextElementSibling.children;t.hasAttribute("readonly")?t.removeAttribute("readonly"):t.setAttribute("readonly","readonly");for(const e of o)e.classList.toggle("is-hidden")},t=document.querySelectorAll(".is-lock-toggle-button");for(const o of t)o.addEventListener("click",e)})();