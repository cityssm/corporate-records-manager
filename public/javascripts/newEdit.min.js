"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=exports.urlPrefix,t=document.getElementById("record--recordID").value,n=""===t,a=document.getElementById("form--record"),s=function(){cityssm.enableNavBlocker()};a.addEventListener("submit",function(t){t.preventDefault();var s=e+(n?"/new/doCreate":"/edit/doUpdate");cityssm.postJSON(s,a,function(t){t.success?(cityssm.disableNavBlocker(),n?window.location.href=e+"/edit/"+t.recordID.toString():cityssm.alertModal("Record Updated Successfully","","OK","success")):cityssm.alertModal("Error While Saving",t.message,"OK","danger")})}),a.querySelectorAll("input, textarea").forEach(function(e){e.addEventListener("change",s)});var r=function(e){e.preventDefault();var t=e.currentTarget.closest(".tag"),n=t.getElementsByTagName("input")[0].value;cityssm.confirmModal("Remove Tag?",'Are you sure you want to remove the <span class="tag">'+cityssm.escapeHTML(n)+"</span> tag?","Yes, Remove the Tag","warning",function(){t.remove(),s()})};document.getElementById("is-add-tag-button").addEventListener("click",function(){var a,o,d="",c=[],l=function(e){e.preventDefault();var t,n,o,d=document.getElementById("addTag--tag");""!==d.value?(t=d.value,n=cityssm.escapeHTML(t),(o=document.createElement("span")).className="tag is-medium",o.innerHTML='<input name="tags" type="hidden" value="'+n+'" /> '+n+' <button class="delete" type="button" aria-label="Remove Tag"></button>',o.getElementsByTagName("button")[0].addEventListener("click",r),document.getElementById("container--tags").insertAdjacentElement("afterbegin",o),s(),d.value="",d.focus()):a()},i=function(a){a&&(d===o.value||o.value.includes(d)&&c.length<20)||(d=o.value,cityssm.postJSON(e+"/edit/doGetSuggestedTags",{recordID:n?"":t,searchString:o.value},function(e){var t=document.getElementById("addTag--tag-datalist");if(t.innerHTML="",e.success)for(var n=0,a=c=e.tags;n<a.length;n++){var s=a[n],r=document.createElement("option");r.value=s,t.appendChild(r)}}))};cityssm.openHtmlModal("tag-add",{onshown:function(e,t){a=t,document.getElementById("form--addTag").addEventListener("submit",l),(o=document.getElementById("addTag--tag")).focus(),o.addEventListener("keyup",i),i()}})});for(var o=document.getElementsByClassName("is-remove-tag-button"),d=0;d<o.length;d+=1)o[d].addEventListener("click",r)}(),function(){for(var e=function(e){e.preventDefault();var t=e.currentTarget.closest(".field").getElementsByTagName("input")[0],n=t.nextElementSibling.children;t.hasAttribute("readonly")?t.removeAttribute("readonly"):t.setAttribute("readonly","readonly");for(var a=0;a<n.length;a+=1)n[a].classList.toggle("is-hidden")},t=document.getElementsByClassName("is-lock-toggle-button"),n=0;n<t.length;n+=1)t[n].addEventListener("click",e)}();